function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function t(e) {
  return (t = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (t) {
    return _typeof(t);
  } : function (t) {
    return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t);
  })(e);
}

function e(t) {
  return function (t) {
    if (Array.isArray(t)) return i(t);
  }(t) || function (t) {
    if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t);
  }(t) || n(t) || function () {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }();
}

function n(t, e) {
  if (t) {
    if ("string" == typeof t) return i(t, e);
    var n = Object.prototype.toString.call(t).slice(8, -1);
    return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? i(t, e) : void 0;
  }
}

function i(t, e) {
  (null == e || e > t.length) && (e = t.length);

  for (var n = 0, i = new Array(e); n < e; n++) {
    i[n] = t[n];
  }

  return i;
}

function r(t, e) {
  for (var n = 0; n < e.length; n++) {
    var i = e[n];
    i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(t, i.key, i);
  }
}

function a(t, e) {
  if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
}

function o(t, e) {
  if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function");
  t.prototype = Object.create(e && e.prototype, {
    constructor: {
      value: t,
      writable: !0,
      configurable: !0
    }
  }), e && h(t, e);
}

function u(t) {
  var e = f();
  return function () {
    var n,
        i = d(t);

    if (e) {
      var r = d(this).constructor;
      n = Reflect.construct(i, arguments, r);
    } else n = i.apply(this, arguments);

    return c(this, n);
  };
}

function c(e, n) {
  return !n || "object" !== t(n) && "function" != typeof n ? s(e) : n;
}

function s(t) {
  if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return t;
}

function b(t) {
  var e = "function" == typeof Map ? new Map() : void 0;
  return (b = function b(t) {
    if (null === t || (n = t, -1 === Function.toString.call(n).indexOf("[native code]"))) return t;
    var n;
    if ("function" != typeof t) throw new TypeError("Super expression must either be null or a function");

    if (void 0 !== e) {
      if (e.has(t)) return e.get(t);
      e.set(t, i);
    }

    function i() {
      return l(t, arguments, d(this).constructor);
    }

    return i.prototype = Object.create(t.prototype, {
      constructor: {
        value: i,
        enumerable: !1,
        writable: !0,
        configurable: !0
      }
    }), h(i, t);
  })(t);
}

function l(t, e, n) {
  return (l = f() ? Reflect.construct : function (t, e, n) {
    var i = [null];
    i.push.apply(i, e);
    var r = new (Function.bind.apply(t, i))();
    return n && h(r, n.prototype), r;
  }).apply(null, arguments);
}

function f() {
  if ("undefined" == typeof Reflect || !Reflect.construct) return !1;
  if (Reflect.construct.sham) return !1;
  if ("function" == typeof Proxy) return !0;

  try {
    return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;
  } catch (t) {
    return !1;
  }
}

function h(t, e) {
  return (h = Object.setPrototypeOf || function (t, e) {
    return t.__proto__ = e, t;
  })(t, e);
}

function d(t) {
  return (d = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) {
    return t.__proto__ || Object.getPrototypeOf(t);
  })(t);
}

var v = function (t) {
  o(n, b(HTMLElement));
  var e = u(n);

  function n() {
    return a(this, n), e.apply(this, arguments);
  }

  return n;
}();

customElements.define("joomla-tab", v);

var p = function (t) {
  o(h, b(HTMLElement));
  var i,
      c,
      l,
      f = u(h);

  function h() {
    var t;
    return a(this, h), (t = f.call(this)).tabs = [], t.tabsElements = [], t.onMutation = t.onMutation.bind(s(t)), t.keyBehaviour = t.keyBehaviour.bind(s(t)), t.activateTab = t.activateTab.bind(s(t)), t.deactivateTabs = t.deactivateTabs.bind(s(t)), t.checkView = t.checkView.bind(s(t)), t.observer = new MutationObserver(t.onMutation), t.observer.observe(s(t), {
      attributes: !1,
      childList: !0,
      subtree: !0
    }), t;
  }

  return i = h, l = [{
    key: "observedAttributes",
    get: function get() {
      return ["recall", "orientation", "view", "breakpoint"];
    }
  }], (c = [{
    key: "recall",
    get: function get() {
      return this.getAttribute("recall");
    },
    set: function set(t) {
      this.setAttribute("recall", t);
    }
  }, {
    key: "view",
    get: function get() {
      return this.getAttribute("view");
    },
    set: function set(t) {
      this.setAttribute("view", t);
    }
  }, {
    key: "orientation",
    get: function get() {
      return this.getAttribute("orientation");
    },
    set: function set(t) {
      this.setAttribute("orientation", t);
    }
  }, {
    key: "breakpoint",
    get: function get() {
      return parseInt(this.getAttribute("breakpoint"), 10);
    },
    set: function set(t) {
      this.setAttribute("breakpoint", t);
    }
  }, {
    key: "connectedCallback",
    value: function value() {
      var t = this;
      (!this.orientation || this.orientation && !["horizontal", "vertical"].includes(this.orientation)) && (this.orientation = "horizontal"), (!this.view || this.view && !["tabs", "accordion"].includes(this.view)) && (this.view = "tabs"), this.tabsElements = [].slice.call(this.children).filter(function (t) {
        return "joomla-tab" === t.tagName.toLowerCase();
      }), this.tabsElements.length && (this.hydrate(), this.hasAttribute("recall") && this.activateFromState(), this.addEventListener("keyup", this.keyBehaviour), this.breakpoint && (this.checkView(), window.addEventListener("resize", function () {
        t.checkView();
      })));
    }
  }, {
    key: "disconnectedCallback",
    value: function value() {
      var t = this;
      this.tabs.map(function (e) {
        return e.tabButton.removeEventListener("click", t.activateTab), e.accordionButton.removeEventListener("click", t.activateTab), e;
      }), this.removeEventListener("keyup", this.keyBehaviour);
    }
  }, {
    key: "attributeChangedCallback",
    value: function value(t, e, n) {
      switch (t) {
        case "view":
          (!n || n && !["tabs", "accordion"].includes(n)) && (this.view = "tabs"), "tabs" === n && n !== e ? (this.tabButtonContainer && this.tabButtonContainer.removeAttribute("hidden"), this.tabs.map(function (t) {
            return t.accordionButton.setAttribute("hidden", "");
          })) : "accordion" === n && n !== e && (this.tabButtonContainer && this.tabButtonContainer.setAttribute("hidden", ""), this.tabs.map(function (t) {
            return t.accordionButton.removeAttribute("hidden");
          }));
      }
    }
  }, {
    key: "hydrate",
    value: function value() {
      var t = this;
      this.tabButtonContainer = document.createElement("div"), this.tabButtonContainer.setAttribute("role", "tablist"), this.insertAdjacentElement("afterbegin", this.tabButtonContainer), "accordion" === this.view && this.tabButtonContainer.setAttribute("hidden", ""), this.tabsElements.map(function (e) {
        var n = document.createElement("button");
        n.setAttribute("aria-expanded", !!e.hasAttribute("active")), n.setAttribute("aria-controls", e.id), n.innerHTML = '<span class="accordion-title">'.concat(e.getAttribute("name"), '<span class="accordion-icon"></span></span>'), e.insertAdjacentElement("beforebegin", n), "tabs" === t.view && n.setAttribute("hidden", ""), n.addEventListener("click", t.activateTab);
        var i = document.createElement("button");
        return i.setAttribute("aria-expanded", !!e.hasAttribute("active")), i.setAttribute("aria-controls", e.id), i.setAttribute("role", "tab"), i.innerHTML = "".concat(e.getAttribute("name")), t.tabButtonContainer.appendChild(i), i.addEventListener("click", t.activateTab), "tabs" === t.view ? e.setAttribute("role", "tabpanel") : e.setAttribute("role", "region"), t.tabs.push({
          tab: e,
          tabButton: i,
          accordionButton: n
        }), e;
      });
    }
  }, {
    key: "onMutation",
    value: function value(t) {
      var e,
          i = function (t, e) {
        var i = "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"];

        if (!i) {
          if (Array.isArray(t) || (i = n(t)) || e && t && "number" == typeof t.length) {
            i && (t = i);

            var r = 0,
                a = function a() {};

            return {
              s: a,
              n: function n() {
                return r >= t.length ? {
                  done: !0
                } : {
                  done: !1,
                  value: t[r++]
                };
              },
              e: function e(t) {
                throw t;
              },
              f: a
            };
          }

          throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
        }

        var o,
            u = !0,
            c = !1;
        return {
          s: function s() {
            i = i.call(t);
          },
          n: function n() {
            var t = i.next();
            return u = t.done, t;
          },
          e: function e(t) {
            c = !0, o = t;
          },
          f: function f() {
            try {
              u || null == i["return"] || i["return"]();
            } finally {
              if (c) throw o;
            }
          }
        };
      }(t);

      try {
        for (i.s(); !(e = i.n()).done;) {
          var r = e.value;
          "childList" === r.type && (r.addedNodes.length, r.removedNodes.length);
        }
      } catch (t) {
        i.e(t);
      } finally {
        i.f();
      }
    }
  }, {
    key: "keyBehaviour",
    value: function value(t) {
      if ([].concat(e(this.tabs.map(function (t) {
        return t.tabButton;
      })), e(this.tabs.map(function (t) {
        return t.accordionButton;
      }))).includes(document.activeElement) && !t.metaKey && !t.altKey) {
        var n, i;

        if ("tabs" === this.view) {
          var r = this.tabs.findIndex(function (t) {
            return t.tab.hasAttribute("active");
          });
          n = r - 1 >= 0 ? this.tabs[r - 1] : this.tabs[this.tabs.length - 1], i = r + 1 <= this.tabs.length - 1 ? this.tabs[r + 1] : this.tabs[0];
        } else {
          var a = this.tabs.map(function (t) {
            return t.accordionButton;
          }).findIndex(function (t) {
            return t === document.activeElement;
          });
          n = a - 1 >= 0 ? this.tabs[a - 1] : this.tabs[this.tabs.length - 1], i = a + 1 <= this.tabs.length - 1 ? this.tabs[a + 1] : this.tabs[0];
        }

        switch (t.keyCode) {
          case 37:
          case 38:
            "tabs" === this.view ? (n.tabButton.click(), n.tabButton.focus()) : n.accordionButton.focus(), t.preventDefault();
            break;

          case 39:
          case 40:
            "tabs" === this.view ? (i.tabButton.click(), i.tabButton.focus()) : i.accordionButton.focus(), t.preventDefault();
        }
      }
    }
  }, {
    key: "deactivateTabs",
    value: function value() {
      var t = this;
      this.tabs.map(function (e) {
        return e.accordionButton.removeAttribute("aria-disabled"), e.tab.hasAttribute("active") && (e.tabButton.removeAttribute("aria-expanded"), e.accordionButton.setAttribute("aria-expanded", !1), e.tab.removeAttribute("active"), e.tab.setAttribute("tabindex", "-1"), t.dispatchCustomEvent("joomla.tab.hidden", "tabs" === t.view ? e.tabButton : e.accordionButton, e.tab)), e;
      });
    }
  }, {
    key: "activateTab",
    value: function value(t) {
      var e,
          n = this,
          i = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];

      if (t.currentTarget ? e = this.tabs.find(function (e) {
        return ("tabs" === n.view ? e.tabButton : e.accordionButton) === t.currentTarget;
      }) : t instanceof HTMLElement ? e = this.tabs.find(function (e) {
        return e.tab === t;
      }) : Number.isInteger(t) && (e = this.tabs[t]), e) {
        if ("accordion" === this.view && this.tabs.find(function (t) {
          return t.tab.hasAttribute("active");
        }) === e) return void e.tab.removeAttribute("active");
        this.deactivateTabs(), e.tabButton.setAttribute("aria-expanded", !0), e.accordionButton.setAttribute("aria-expanded", !0), e.accordionButton.setAttribute("aria-disabled", !0), e.tab.setAttribute("active", ""), e.tabButton.removeAttribute("tabindex"), "tabs" === this.view ? e.tabButton.focus() : e.accordionButton.focus(), i && this.saveState(e.tab.id);
      }
    }
  }, {
    key: "checkView",
    value: function value() {
      if (this.breakpoint) if (document.body.getBoundingClientRect().width > this.breakpoint) {
        if ("tabs" === this.view) return;
        this.tabButtonContainer.removeAttribute("hidden"), this.tabs.map(function (t) {
          return t.accordionButton.setAttribute("hidden", ""), t.accordionButton.setAttribute("role", "tabpanel"), "true" === t.tabButton.getAttribute("aria-selected") && t.tab.setAttribute("active", ""), t;
        }), this.setAttribute("view", "tabs");
      } else {
        if ("accordion" === this.view) return;
        this.tabButtonContainer.setAttribute("hidden", ""), this.tabs.map(function (t) {
          return t.accordionButton.removeAttribute("hidden"), t.accordionButton.setAttribute("role", "region"), t;
        }), this.setAttribute("view", "accordion");
      }
    }
  }, {
    key: "getStorageKey",
    value: function value() {
      return window.location.href.toString().split(window.location.host)[1].replace(/&return=[a-zA-Z0-9%]+/, "").split("#")[0];
    }
  }, {
    key: "saveState",
    value: function value(t) {
      var e = this.getStorageKey();
      sessionStorage.setItem(e, t);
    }
  }, {
    key: "activateFromState",
    value: function value() {
      var t = this,
          e = sessionStorage.getItem(this.getStorageKey());

      if (e) {
        var n,
            i = this.tabs.findIndex(function (t) {
          return t.tab.id === e;
        });
        if (i >= 0) this.activateTab(i, !1);else if (this.querySelector("joomla-tabs")) {
          [].slice.call(this.querySelectorAll("joomla-tab")).forEach(function (i) {
            i.parentNode !== t && (i.removeAttribute("active"), i.id === e && (i.setAttribute("active", ""), n = i));
          });
          var r = n.parentNode.closest("joomla-tab");
          this.activateTab(r, !1);
        }
      }
    }
  }, {
    key: "dispatchCustomEvent",
    value: function value(t, e, n) {
      var i = new CustomEvent(t, {
        bubbles: !0,
        cancelable: !0
      });
      i.relatedTarget = n, e.dispatchEvent(i);
    }
  }]) && r(i.prototype, c), l && r(i, l), h;
}();

customElements.define("joomla-tabs", p);
